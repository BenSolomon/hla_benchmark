gg_accuracy()
c1_a
accuracy_df
accuracy_df %>%
select(sample, locus, field, genotyper, accuracy)
accuracy_df %>%
select(sample, locus, field, genotyper, accuracy) %>%
separate(sample, into = c('sample','time'), sep = '-') %>%
fitler(time != "CV")
accuracy_df %>%
select(sample, locus, field, genotyper, accuracy) %>%
separate(sample, into = c('sample','time'), sep = '-') %>%
filter(time != "CV")
accuracy_df %>%
select(sample, locus, field, genotyper, accuracy) %>%
separate(sample, into = c('sample','time'), sep = '-') %>%
filter(time != "CV") %>%
pivot_wider(names_from = "time", values_from = "accuracy")
compare_hla(hla_df = all_hla_expanded %>% filter(grepl("BL$", sample)),
reference = "invitro",
exclude_missing = F,
compare_function = "accuracy") %>%
select(sample, locus, field, genotyper, accuracy) %>%
separate(sample, into = c('sample','time'), sep = '-') %>%
filter(time != "CV") %>%
pivot_wider(names_from = "time", values_from = "accuracy")
all_hla_expanded
x <- compare_hla(hla_df = all_hla_expanded %>% filter(grepl("BL$", sample)),
reference = "invitro",
exclude_missing = F,
compare_function = "accuracy") %>%
select(sample, locus, field, genotyper, accuracy) %>%
separate(sample, into = c('sample','time'), sep = '-')
x
View(x)
x <- compare_hla(hla_df = all_hla_expanded),
x <- compare_hla(hla_df = all_hla_expanded,
reference = "invitro",
exclude_missing = F,
compare_function = "accuracy") %>%
select(sample, locus, field, genotyper, accuracy) %>%
separate(sample, into = c('sample','time'), sep = '-')
x
y <- x %>%
filter(time != "CV") %>%
pivot_wider(names_from = "time", values_from = "accuracy")
y
y <- x %>%
filter(time != "CV|PD1") %>%
pivot_wider(names_from = "time", values_from = "accuracy")
y
y <- x %>%
filter(time %!in% c("CV", "PD1")) %>%
pivot_wider(names_from = "time", values_from = "accuracy")
y <- x %>%
filter(time !%in% c("CV", "PD1")) %>%
y <- x %>%
filter(!(time %in% c("CV", "PD1"))) %>%
pivot_wider(names_from = "time", values_from = "accuracy")
y
y %>%
mutate(expected = AC * BC)
y %>%
mutate(expected = AC * BL)
y %>%
mutate(accuracy = AC * BL) %>%
gg_accuracy
y %>%
mutate(accuracy = AC * BL) %>%
gg_accuracy
accuracy_df <- compare_hla(hla_df = all_hla_expanded,
reference = "invitro",
exclude_missing = F,
compare_function = "accuracy") %>%
select(sample, locus, field, genotyper, accuracy) %>%
separate(sample, into = c('sample','time'), sep = '-')
accuracy_df <- compare_hla(hla_df = all_hla_expanded,
reference = "invitro",
exclude_missing = F,
compare_function = "accuracy") %>%
select(sample, locus, field, genotyper, accuracy) %>%
separate(sample, into = c('sample','time'), sep = '-')
accuracy_df %>% filter(grepl("^[ABC]", locus) & time == "BL") %>% gg_accuracy()
accuracy_df %>% filter(grepl("^[ABC]", locus) & time == "AC") %>% gg_accuracy()
accuracy_df %>% filter(grepl("^D", locus) & time == "BL") %>% gg_accuracy()
accuracy_df %>% filter(grepl("^D", locus) & time == "AC") %>% gg_accuracy()
agreement_hla(all_hla_expanded, collections = c("AC", "BL"), complete_match = T) %>% gg_accuracy()
# agreement_hla(all_hla_expanded, collections = c("AC", "BL"), complete_match = F) %>% gg_accuracy()
accuracy_df %>%
filter(!(time %in% c("CV", "PD1"))) %>%
pivot_wider(names_from = "time", values_from = "accuracy") %>%
mutate(accuracy = AC * BL) %>%
gg_accuracy
agreement_hla(all_hla_expanded, collections = c("AC", "BL"), complete_match = T)
accuracy_df %>%
filter(!(time %in% c("CV", "PD1"))) %>%
pivot_wider(names_from = "time", values_from = "accuracy") %>%
mutate(accuracy = AC * BL)
agreement_hla(all_hla_expanded, collections = c("AC", "BL"), complete_match = T) %>%
left_join(
accuracy_df %>%
filter(!(time %in% c("CV", "PD1"))) %>%
pivot_wider(names_from = "time", values_from = "accuracy") %>%
mutate(accuracy = AC * BL) %>%
select(-AC, -BL),
join_by = c("sample", "locus", "field", "genotyper")
)
agreement_hla(all_hla_expanded, collections = c("AC", "BL"), complete_match = T)
agreement_hla(all_hla_expanded, collections = c("AC", "BL"), complete_match = T) %>%
sample(sample, locus, genotyper, field, accuracy)
agreement_hla(all_hla_expanded, collections = c("AC", "BL"), complete_match = T) %>%
select(sample, locus, genotyper, field, accuracy)
agreement_hla(all_hla_expanded, collections = c("AC", "BL"), complete_match = T) %>%
select(sample, locus, genotyper, field, accuracy) %>%
left_join(
accuracy_df %>%
filter(!(time %in% c("CV", "PD1"))) %>%
pivot_wider(names_from = "time", values_from = "accuracy") %>%
mutate(accuracy_2 = AC * BL) %>%
select(-AC, -BL),
join_by = c("sample", "locus", "field", "genotyper")
)
agreement_hla(all_hla_expanded, collections = c("AC", "BL"), complete_match = T) %>%
select(sample, locus, genotyper, field, accuracy) %>%
left_join(
accuracy_df %>%
filter(!(time %in% c("CV", "PD1"))) %>%
pivot_wider(names_from = "time", values_from = "accuracy") %>%
mutate(accuracy = AC * BL) %>%
select(-AC, -BL),
join_by = c("sample", "locus", "field", "genotyper")
)
agreement_hla(all_hla_expanded, collections = c("AC", "BL"), complete_match = T) %>%
select(sample, locus, genotyper, field, observed_accuracy = accuracy) %>%
left_join(
accuracy_df %>%
filter(!(time %in% c("CV", "PD1"))) %>%
pivot_wider(names_from = "time", values_from = "accuracy") %>%
mutate(expected_accuracy = AC * BL) %>%
select(-AC, -BL),
join_by = c("sample", "locus", "field", "genotyper")
)
agreement_hla(all_hla_expanded, collections = c("AC", "BL"), complete_match = T) %>%
select(sample, locus, genotyper, field, observed_agreement = accuracy) %>%
left_join(
accuracy_df %>%
filter(!(time %in% c("CV", "PD1"))) %>%
pivot_wider(names_from = "time", values_from = "accuracy") %>%
mutate(expected_agreement = AC * BL) %>%
select(-AC, -BL),
join_by = c("sample", "locus", "field", "genotyper")
)
agreement_hla(all_hla_expanded, collections = c("AC", "BL"), complete_match = T) %>%
select(sample, locus, genotyper, field, observed_agreement = accuracy) %>%
left_join(
accuracy_df %>%
filter(!(time %in% c("CV", "PD1"))) %>%
pivot_wider(names_from = "time", values_from = "accuracy") %>%
mutate(expected_agreement = AC * BL) %>%
select(-AC, -BL),
join_by = c("sample", "locus", "field", "genotyper")
) %>%
drop_na()
agreement_hla(all_hla_expanded, collections = c("AC", "BL"), complete_match = T) %>%
select(sample, locus, genotyper, field, agreement_observed = accuracy) %>%
left_join(
accuracy_df %>%
filter(!(time %in% c("CV", "PD1"))) %>%
pivot_wider(names_from = "time", values_from = "accuracy") %>%
mutate(agreement_expected = AC * BL) %>%
select(-AC, -BL),
join_by = c("sample", "locus", "field", "genotyper")
) %>%
drop_na() %>%
pivot_longer(cols = contains("agreement"), names_to = "agreement", names_prefix = "metric", values_to = "agreement")
agreement_hla(all_hla_expanded, collections = c("AC", "BL"), complete_match = T) %>%
select(sample, locus, genotyper, field, agreement_observed = accuracy) %>%
left_join(
accuracy_df %>%
filter(!(time %in% c("CV", "PD1"))) %>%
pivot_wider(names_from = "time", values_from = "accuracy") %>%
mutate(agreement_expected = AC * BL) %>%
select(-AC, -BL),
join_by = c("sample", "locus", "field", "genotyper")
) %>%
drop_na() %>%
pivot_longer(cols = contains("agreement"), names_to = "metric", names_prefix = "agreement_", values_to = "agreement")
x <- agreement_hla(all_hla_expanded, collections = c("AC", "BL"), complete_match = T) %>%
select(sample, locus, genotyper, field, agreement_observed = accuracy) %>%
left_join(
accuracy_df %>%
filter(!(time %in% c("CV", "PD1"))) %>%
pivot_wider(names_from = "time", values_from = "accuracy") %>%
mutate(agreement_expected = AC * BL) %>%
select(-AC, -BL),
join_by = c("sample", "locus", "field", "genotyper")
) %>%
drop_na() %>%
pivot_longer(cols = contains("agreement"), names_to = "metric", names_prefix = "agreement_", values_to = "agreement")
x
x %>%
ggplot(aes(x = field, y = accuracy))+
stat_summary(fun = mean, geom = "point", position = position_dodge(width=0.9)) +
stat_summary(fun.data = mean_se, geom = "errorbar", position=position_dodge(width=0.9)) +
theme_bw() +
facet_nested(.~locus+genotyper, scales = "free_y") +
coord_cartesian(ylim = c(0,1))+
scale_y_continuous(n.breaks = 6)+
labs(y = "Accuracy", x = "")+
theme(axis.text.x = element_text(angle = 90))+
theme(panel.spacing = unit(0.1,"line"))
x %>%
ggplot(aes(x = field, y = agreement))+
stat_summary(fun = mean, geom = "point", position = position_dodge(width=0.9)) +
stat_summary(fun.data = mean_se, geom = "errorbar", position=position_dodge(width=0.9)) +
theme_bw() +
facet_nested(.~locus+genotyper, scales = "free_y") +
coord_cartesian(ylim = c(0,1))+
scale_y_continuous(n.breaks = 6)+
labs(y = "Accuracy", x = "")+
theme(axis.text.x = element_text(angle = 90))+
theme(panel.spacing = unit(0.1,"line"))
x %>%
ggplot(aes(x = field, y = agreement))+
stat_summary(fun = mean, geom = "point", position = position_dodge(width=0.9)) +
stat_summary(fun.data = mean_se, geom = "errorbar", position=position_dodge(width=0.9)) +
theme_bw() +
facet_nested(.~locus+genotyper, scales = "free_y") +
coord_cartesian(ylim = c(0,1))+
scale_y_continuous(n.breaks = 6)+
labs(y = "Accuracy", x = "")+
theme(axis.text.x = element_text(angle = 90))+
theme(panel.spacing = unit(0.1,"line"))
x %>%
ggplot(aes(x = field, y = agreement))+
stat_summary(fun = mean, geom = "point", position = position_dodge(width=0.9)) +
stat_summary(fun.data = mean_se, geom = "errorbar", position=position_dodge(width=0.9)) +
theme_bw() +
facet_nested(.~locus+genotyper, scales = "free_y") +
coord_cartesian(ylim = c(0,1))+
scale_y_continuous(n.breaks = 6)+
labs(y = "Accuracy", x = "")+
theme(axis.text.x = element_text(angle = 90))+
theme(panel.spacing = unit(0.1,"line"))
x %>%
ggplot(aes(x = field, y = agreement))+
stat_summary(fun = mean, geom = "point", position = position_dodge(width=0.9)) +
stat_summary(fun.data = mean_se, geom = "errorbar", position=position_dodge(width=0.9)) +
theme_bw() +
facet_nested(.~locus+genotyper, scales = "free_y") +
coord_cartesian(ylim = c(0,1))+
scale_y_continuous(n.breaks = 6)+
labs(y = "Accuracy", x = "")+
theme(axis.text.x = element_text(angle = 90))+
theme(panel.spacing = unit(0.1,"line"))
x %>%
ggplot(aes(x = field, y = agreement))+
stat_summary(fun = mean, geom = "point", position = position_dodge(width=0.9)) +
stat_summary(fun.data = mean_se, geom = "errorbar", position=position_dodge(width=0.9)) +
theme_bw() +
facet_nested(.~locus+genotyper, scales = "free_y") +
coord_cartesian(ylim = c(0,1))+
scale_y_continuous(n.breaks = 6)+
labs(y = "Accuracy", x = "")+
theme(axis.text.x = element_text(angle = 90))+
theme(panel.spacing = unit(0.1,"line"))
x %>%
ggplot(aes(x = field, y = agreement))+
stat_summary(fun = mean, geom = "point", position = position_dodge(width=0.9)) +
stat_summary(fun.data = mean_se, geom = "errorbar", position=position_dodge(width=0.9)) +
theme_bw() +
facet_nested_wrap(~metric+locus+genotyper, scales = "free_y") +
coord_cartesian(ylim = c(0,1))+
scale_y_continuous(n.breaks = 6)+
labs(y = "Accuracy", x = "")+
theme(axis.text.x = element_text(angle = 90))+
theme(panel.spacing = unit(0.1,"line"))
x %>%
ggplot(aes(x = field, y = agreement))+
stat_summary(fun = mean, geom = "point", position = position_dodge(width=0.9)) +
stat_summary(fun.data = mean_se, geom = "errorbar", position=position_dodge(width=0.9)) +
theme_bw() +
facet_nested_wrap(~locus+genotyper+metric, scales = "free_y") +
coord_cartesian(ylim = c(0,1))+
scale_y_continuous(n.breaks = 6)+
labs(y = "Accuracy", x = "")+
theme(axis.text.x = element_text(angle = 90))+
theme(panel.spacing = unit(0.1,"line"))
x %>%
ggplot(aes(x = metric, y = agreement))+
stat_summary(fun = mean, geom = "point", position = position_dodge(width=0.9)) +
stat_summary(fun.data = mean_se, geom = "errorbar", position=position_dodge(width=0.9)) +
theme_bw() +
facet_nested_wrap(~locus+genotyper+field, scales = "free_y") +
coord_cartesian(ylim = c(0,1))+
scale_y_continuous(n.breaks = 6)+
labs(y = "Accuracy", x = "")+
theme(axis.text.x = element_text(angle = 90))+
theme(panel.spacing = unit(0.1,"line"))
x %>%
filter(field == "field_2")
ggplot(aes(x = metric, y = agreement))+
stat_summary(fun = mean, geom = "point", position = position_dodge(width=0.9)) +
stat_summary(fun.data = mean_se, geom = "errorbar", position=position_dodge(width=0.9)) +
theme_bw() +
facet_nested(.~locus+genotyper, scales = "free_y") +
coord_cartesian(ylim = c(0,1))+
scale_y_continuous(n.breaks = 6)+
labs(y = "Accuracy", x = "")+
theme(axis.text.x = element_text(angle = 90))+
theme(panel.spacing = unit(0.1,"line"))
x %>%
filter(field == "field_2") %>%
ggplot(aes(x = metric, y = agreement))+
stat_summary(fun = mean, geom = "point", position = position_dodge(width=0.9)) +
stat_summary(fun.data = mean_se, geom = "errorbar", position=position_dodge(width=0.9)) +
theme_bw() +
facet_nested(.~locus+genotyper, scales = "free_y") +
coord_cartesian(ylim = c(0,1))+
scale_y_continuous(n.breaks = 6)+
labs(y = "Accuracy", x = "")+
theme(axis.text.x = element_text(angle = 90))+
theme(panel.spacing = unit(0.1,"line"))
x %>%
filter(field == "field_2") %>%
ggplot(aes(x = metric, y = agreement))+
stat_summary(fun = mean, geom = "point", position = position_dodge(width=0.9)) +
stat_summary(fun.data = mean_se, geom = "errorbar", position=position_dodge(width=0.9)) +
theme_bw() +
facet_nested(.~locus+genotyper, scales = "free_y") +
coord_cartesian(ylim = c(0,1))+
scale_y_continuous(n.breaks = 6)+
labs(y = "Accuracy", x = "")+
theme(axis.text.x = element_text(angle = 90))+
theme(panel.spacing = unit(0.1,"line"))
View(all_hla_expanded)
library(tidyverse)
library(broom)
library(vegan)
library(lubridate)
library(ggh4x)
library(checkmate)
isb_path <- "/labs/khatrilab/solomonb/covid/isb"
isb_samples <- read_tsv("/labs/khatrilab/solomonb/covid/isb/logs/210217_232725/parallel.log") %>%
separate(Command, into = c(NA, "sample"), sep = " ") %>%
pull(sample) %>% unique()
all_hla <- format_hla_table(combine_HLA_import(path = isb_path, samples = isb_samples)) %>%
bind_rows(invitro_hla)
invitro_hla <- invitro_import()
all_hla <- format_hla_table(combine_HLA_import(path = isb_path, samples = isb_samples)) %>%
bind_rows(invitro_hla)
agreement_hla(all_hla, collections = c("AC", "BL"), complete_match = T) %>% gg_accuracy()
agreement_hla(all_hla, collections = c("AC", "BL"), complete_match = F) %>% gg_accuracy()
agreement_hla(all_hla_expanded, collections = c("AC", "BL"), complete_match = F) %>% gg_accuracy()
x <- agreement_hla(all_hla_expanded, collections = c("AC", "BL"), complete_match = F) %>%
select(sample, locus, genotyper, field, agreement_observed = accuracy) %>%
left_join(
accuracy_df %>%
filter(!(time %in% c("CV", "PD1"))) %>%
pivot_wider(names_from = "time", values_from = "accuracy") %>%
mutate(agreement_expected = AC * BL) %>%
select(-AC, -BL),
join_by = c("sample", "locus", "field", "genotyper")
) %>%
drop_na() %>%
pivot_longer(cols = contains("agreement"), names_to = "metric", names_prefix = "agreement_", values_to = "agreement")
x %>%
filter(field == "field_2") %>%
ggplot(aes(x = metric, y = agreement))+
stat_summary(fun = mean, geom = "point", position = position_dodge(width=0.9)) +
stat_summary(fun.data = mean_se, geom = "errorbar", position=position_dodge(width=0.9)) +
theme_bw() +
facet_nested(.~locus+genotyper, scales = "free_y") +
coord_cartesian(ylim = c(0,1))+
scale_y_continuous(n.breaks = 6)+
labs(y = "Accuracy", x = "")+
theme(axis.text.x = element_text(angle = 90))+
theme(panel.spacing = unit(0.1,"line"))
x <- agreement_hla(all_hla_expanded, collections = c("AC", "BL"), complete_match = F) %>%
select(sample, locus, genotyper, field, agreement_observed = accuracy) %>%
left_join(
accuracy_df %>%
filter(!(time %in% c("CV", "PD1"))) %>%
pivot_wider(names_from = "time", values_from = "accuracy") %>%
mutate(agreement_expected = AC * BL) %>%
select(-AC, -BL),
join_by = c("sample", "locus", "field", "genotyper")
) %>%
# drop_na() %>%
pivot_longer(cols = contains("agreement"), names_to = "metric", names_prefix = "agreement_", values_to = "agreement")
x %>%
filter(field == "field_2") %>%
ggplot(aes(x = metric, y = agreement))+
stat_summary(fun = mean, geom = "point", position = position_dodge(width=0.9)) +
stat_summary(fun.data = mean_se, geom = "errorbar", position=position_dodge(width=0.9)) +
theme_bw() +
facet_nested(.~locus+genotyper, scales = "free_y") +
coord_cartesian(ylim = c(0,1))+
scale_y_continuous(n.breaks = 6)+
labs(y = "Accuracy", x = "")+
theme(axis.text.x = element_text(angle = 90))+
theme(panel.spacing = unit(0.1,"line"))
x <- agreement_hla(all_hla_expanded, collections = c("AC", "BL"), complete_match = F) %>%
select(sample, locus, genotyper, field, agreement_observed = accuracy) %>%
left_join(
accuracy_df %>%
filter(!(time %in% c("CV", "PD1"))) %>%
pivot_wider(names_from = "time", values_from = "accuracy") %>%
mutate(agreement_expected = AC * BL) %>%
select(-AC, -BL),
join_by = c("sample", "locus", "field", "genotyper")
) %>%
drop_na() %>%
pivot_longer(cols = contains("agreement"), names_to = "metric", names_prefix = "agreement_", values_to = "agreement")
x %>%
filter(field == "field_2") %>%
ggplot(aes(x = metric, y = agreement))+
stat_summary(fun = mean, geom = "point", position = position_dodge(width=0.9)) +
stat_summary(fun.data = mean_se, geom = "errorbar", position=position_dodge(width=0.9)) +
theme_bw() +
facet_nested(.~locus+genotyper, scales = "free_y") +
coord_cartesian(ylim = c(0,1))+
scale_y_continuous(n.breaks = 6)+
labs(y = "Accuracy", x = "")+
theme(axis.text.x = element_text(angle = 90))+
theme(panel.spacing = unit(0.1,"line"))
View(all_hla_expanded)
read_tsv("../../covid/isb/scHLAcount/all_fastq_files.txt")
read_tsv("../../covid/isb/scHLAcount/all_fastq_files.txt", col_names = sample)
read_tsv("../../covid/isb/scHLAcount/all_fastq_files.txt", col_names = "sample")
read_tsv("../../covid/isb/scHLAcount/all_fastq_files.txt", col_names = "sample") %>%
grepl("^INCOV", sample) %>%
separate(sample, into = c("sample", "pool"), sep = "_")
read_tsv("../../covid/isb/scHLAcount/all_fastq_files.txt", col_names = "sample") %>%
filter(grepl("^INCOV", sample)) %>%
separate(sample, into = c("sample", "pool"), sep = "_")
read_tsv("../../covid/isb/scHLAcount/all_fastq_files.txt", col_names = "sample") %>%
filter(grepl("^INCOV", sample)) %>%
separate(sample, into = c("sample", "pool"), sep = "_") %>%
drop_na()
read_tsv("../../covid/isb/scHLAcount/all_fastq_files.txt", col_names = "sample") %>%
# filter(grepl("^INCOV", sample)) %>%
separate(sample, into = c("sample", "pool"), sep = "_") %>%
drop_na()
read_tsv("../../covid/isb/scHLAcount/all_fastq_files.txt", col_names = "sample") %>%
filter(grepl("^INCOV", sample)) %>%
separate(sample, into = c("sample", "pool"), sep = "_") %>%
drop_na()
read_tsv("../../covid/isb/scHLAcount/all_fastq_files.txt", col_names = "sample") %>%
filter(grepl("^INCOV", sample)) %>%
separate(sample, into = c("sample", "pool"), sep = "_", remove = F) %>%
drop_na()
read_tsv("../../covid/isb/scHLAcount/all_fastq_files.txt", col_names = "file") %>%
filter(grepl("^INCOV", file)) %>%
separate(sample, into = c("sample", "pool"), sep = "_", remove = F) %>%
drop_na()
read_tsv("../../covid/isb/scHLAcount/all_fastq_files.txt", col_names = "file") %>%
filter(grepl("^INCOV", file)) %>%
separate(file, into = c("sample", "pool"), sep = "_", remove = F) %>%
drop_na()
all_hla_expanded
all_hla_expanded %>%
filter(grepl("^[ABC]", locus))
all_hla_expanded %>%
filter(grepl("^[ABC]", locus)) %>%
mutate(allele = str_replace_all(field_3, "_", ":"))
x <- all_hla_expanded %>%
filter(grepl("^[ABC]", locus)) %>%
mutate(allele = str_replace_all(field_3, "_", ":"))
View(x)
c(1,NA,NA) %>% tail()
c(1,NA,NA) %>% tail(1)
c(1,2,NA,NA)
c(1,2,NA,NA) %>% is.na()
c(1,2,NA,NA) %>% filter(is.na())
c(1,2,NA,NA) %>% filter(is.na(.))
c(1,2,NA,NA) %>% filter(is.na(.),.)
c(1,2,NA,NA) %>% function(x){x[!is.na(x)]}
c(1,2,NA,NA) %>% {function(x) x[!is.na(x)]}
c(1,2,NA,NA) %>% function(x) x[!is.na(x)]
c(1,2,NA,NA) %>% (function(x) x[!is.na(x)])
c(1,2,NA,NA) %>% (function(x) x[!is.na(x)] %>% tail(1))
x %>%
head()
x %>%
head() %>%
rowwise() %>%
mutate(test = length(across(contains("field"))))
select_last_allele <- function(x){x[!is.na(x)] %>% tail(1))}
select_last_allele <- function(x){x[!is.na(x)] %>% tail(1)}
x %>%
head() %>%
rowwise() %>%
mutate(test = select_last_allele(across(contains("field"))))
select_last_allele <- function(x){x[!is.na(x)] %>% tail(1)}
x %>%
head(50) %>%
rowwise() %>%
mutate(test = select_last_allele(across(contains("field"))))
select_last_allele <- function(x){x[!is.na(x)] %>% tail(1)}
x %>%
head(100) %>%
rowwise() %>%
mutate(test = select_last_allele(across(contains("field"))))
select_last_allele <- function(x){x[!is.na(x)] %>% tail(1)}
x %>%
rowwise() %>%
mutate(test = select_last_allele(across(contains("field"))))
read_tsv("../../covid/isb/scHLAcount/all_fastq_files.txt", col_names = "file") %>%
filter(grepl("^INCOV", file)) %>%
separate(file, into = c("sample", "pool"), sep = "_", remove = F) %>%
drop_na()
